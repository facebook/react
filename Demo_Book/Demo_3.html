<!-- http://huziketang.com/books/react/lesson3 -->
<!-- ä¼˜åŒ–çš„ç©ºé—´ï¼šå¦‚ä½•å°½é‡å‡å°‘è¿™ç§æ‰‹åŠ¨ DOM æ“ä½œï¼Ÿ -->
<!-- çŠ¶æ€æ”¹å˜ -> æ„å»ºæ–°çš„ DOM å…ƒç´ æ›´æ–°é¡µé¢ -->

<!-- ä¸€æ—¦çŠ¶æ€å‘ç”Ÿæ”¹å˜ï¼Œå°±é‡æ–°è°ƒç”¨ render æ–¹æ³•ï¼Œæ„å»ºä¸€ä¸ªæ–°çš„ DOM å…ƒç´  -->
<!-- å¥½å¤„å°±æ˜¯ä½ å¯ä»¥åœ¨ render æ–¹æ³•é‡Œé¢ä½¿ç”¨æœ€æ–°çš„ this.state æ¥æ„é€ ä¸åŒ HTML ç»“æ„çš„å­—ç¬¦ä¸²ï¼Œå¹¶ä¸”é€šè¿‡è¿™ä¸ªå­—ç¬¦ä¸²æ„é€ ä¸åŒçš„ DOM å…ƒç´ ã€‚é¡µé¢å°±æ›´æ–°äº†ï¼ -->

<div class='wrapper'> </div> 

<script>
    const wrapper = document.querySelector('.wrapper')

    // å‡çº§ Class å°†string è½¬ä¸ºDom ï¼Œæ¥ç€æ’å…¥ç›‘å¬æŒ‰é’®äº‹ä»¶
    class LikeButton {
        constructor() {
            this.state = {isLiked: false}
        }

        //æ–°å¢__åˆ©ç”¨å®ƒï¼Œæ¥æ§åˆ¶çŠ¶æ€ä¸æ¸²æŸ“.
        setState(state) {   
            const oldEl = this.el           //ä¿å­˜æ—§DOM
            this.state = state              //æ›´æ–°çŠ¶æ€
            this.el = this.render()         //æ›´æ–°DOM
            if( this.onStateChange ) this.onStateChange(oldEl, this.el)     //è°ƒç”¨å®ä¾‹æ–¹æ³•.
        }

        changeLikeText() {
            this.setState(
                {isLiked : !this.state.isLiked}
            )
        }

        render() {
            this.el = createDOMFromString(`
                <button class='like-btn'>
                    <span class='like-text'>${this.state.isLiked? 'å–æ¶ˆ' : 'ç‚¹èµ'}</span>
                    <span>ğŸ‘</span>
                </button>
            `)
            // ä¼šå…ˆç»™è½¬åŒ–åçš„DOMåŠ ä¸Šäº‹ä»¶.å†è¿”å›.
            this.el.addEventListener('click', this.changeLikeText.bind(this), true)
            return this.el
        }
    }

    // String è½¬ä¸º DOM
    const createDOMFromString = (dos) => {
        const div = document.createElement('div')
        div.innerHTML = dos
        return div
    }

    const likeButton1 = new LikeButton()
    wrapper.appendChild(likeButton1.render())
    likeButton1.onStateChange = (oldEl, newEl) => {
        wrapper.insertBefore(newEl, oldEl) 
        wrapper.removeChild(oldEl)
    }

</script>