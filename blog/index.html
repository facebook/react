

<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Blog - React</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta property="og:title" content="Blog - React">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://facebook.github.io/react/blog/">
  <meta property="og:image" content="https://facebook.github.io/react/img/logo_og.png">
  <meta property="og:description" content="A JavaScript library for building user interfaces">
  <meta property="fb:app_id" content="623268441017527">

  <link rel="shortcut icon" href="/react/favicon.ico">
  <link rel="alternate" type="application/rss+xml" title="React" href="https://facebook.github.io/react/feed.xml">

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" />
  <link rel="stylesheet" href="/react/css/syntax.css">
  <link rel="stylesheet" href="/react/css/codemirror.css">
  <link rel="stylesheet" href="/react/css/react.css">

  <script src="//use.typekit.net/vqa1hcx.js"></script>
  <script>try{Typekit.load();}catch(e){}</script>

  <!--[if lte IE 8]>
  <script src="https://unpkg.com/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://unpkg.com/es5-shim@4.5.9/es5-shim.min.js"></script>
  <script src="https://unpkg.com/es5-shim@4.5.9/es5-sham.min.js"></script>
  <![endif]-->
  <script src="https://unpkg.com/docsearch.js@1.5.0/dist/cdn/docsearch.min.js"></script>
  <script src="https://unpkg.com/codemirror@5.15.2"></script>
  <script src="https://unpkg.com/codemirror@5.15.2/mode/javascript/javascript.js"></script>
  <script src="https://unpkg.com/codemirror@5.15.2/mode/xml/xml.js"></script>
  <script src="https://unpkg.com/codemirror@5.15.2/mode/jsx/jsx.js"></script>
  <script src="https://unpkg.com/prop-types/prop-types.min.js"></script>
  <script src="https://unpkg.com/react/dist/react.min.js"></script>
  <script src="https://unpkg.com/react-dom/dist/react-dom.min.js"></script>
  <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>
  <script src="/react/js/live_editor.js"></script>
</head>
<body>

  <div class="container">

    <div class="nav-main">
  <div class="wrap">
    <a class="nav-home" href="/react/">
      <img class="nav-logo" src="/react/img/logo.svg" width="36" height="36">
      React
    </a>
    <div class="nav-lists">
      <ul class="nav-site nav-site-internal">
        <li><a href="/react/docs/hello-world.html">Docs</a></li>
        <li><a href="/react/tutorial/tutorial.html">Tutorial</a></li>
        <li><a href="/react/community/support.html">Community</a></li>
        <li><a href="/react/blog/" class="active">Blog</a></li>
        <li class="nav-site-search">
          <input id="algolia-doc-search" type="text" placeholder="Search docs..." />
        </li>
      </ul>
      <ul class="nav-site nav-site-external">
        <li><a href="https://github.com/facebook/react">GitHub</a></li>
        <li><a href="https://github.com/facebook/react/releases">v16.0.0</a></li>
      </ul>
    </div>
  </div>
</div>


    <section class="content wrap blogContent">
  <div class="nav-docs nav-blog">
  <div class="nav-docs-section">
    <h3>Recent posts</h3>
    <ul>
      
        <li><a href="/react/blog/2017/09/26/react-v16.0.html">React v16.0</a></li>
      
        <li><a href="/react/blog/2017/09/25/react-v15.6.2.html">React v15.6.2</a></li>
      
        <li><a href="/react/blog/2017/09/08/dom-attributes-in-react-16.html">DOM Attributes in React 16</a></li>
      
        <li><a href="/react/blog/2017/07/26/error-handling-in-react-16.html">Error Handling in React 16</a></li>
      
        <li><a href="/react/blog/2017/06/13/react-v15.6.0.html">React v15.6.0</a></li>
      
        <li><a href="/react/blog/2017/05/18/whats-new-in-create-react-app.html">What's New in Create React App</a></li>
      
        <li><a href="/react/blog/2017/04/07/react-v15.5.0.html">React v15.5.0</a></li>
      
        <li><a href="/react/blog/2016/11/16/react-v15.4.0.html">React v15.4.0</a></li>
      
        <li><a href="/react/blog/2016/09/28/our-first-50000-stars.html">Our First 50,000 Stars</a></li>
      
        <li><a href="/react/blog/2016/08/05/relay-state-of-the-state.html">Relay: State of the State</a></li>
      
      <li><a href="/react/blog/all.html">All posts ...</a></li>
    </ul>
  </div>
</div>

  <div class="inner-content">
    
      <div class="post-list-item">
        

<h1>

  <a href="/react/blog/2017/09/26/react-v16.0.html">React v16.0</a>

</h1>

<p class="meta">
  September 26, 2017
  by
  
    
      <a href="https://twitter.com/acdlite">Andrew Clark</a>
    
    
  
</p>

<hr>

<div class="post">
  <p>We&#39;re excited to announce the release of React v16.0! Among the changes are some long-standing feature requests, including <a href="#new-render-return-types-fragments-and-strings"><strong>fragments</strong></a>, <a href="#better-error-handling"><strong>error boundaries</strong></a>, <a href="#portals"><strong>portals</strong></a>, support for <a href="#support-for-custom-dom-attributes"><strong>custom DOM attributes</strong></a>, improved <a href="#better-server-side-rendering"><strong>server-side rendering</strong></a>, and <a href="#reduced-file-size"><strong>reduced file size</strong></a>.</p>

<h3>New render return types: fragments and strings</h3>

<p>You can now return an array of elements from a component&#39;s <code>render</code> method. Like with other arrays, you&#39;ll need to add a key to each element to avoid the key warning:</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// No need to wrap list items in an extra element!</span>
  <span class="k">return</span> <span class="p">[</span>
    <span class="c1">// Don&#39;t forget the keys :)</span>
    <span class="o">&lt;</span><span class="nx">li</span> <span class="nx">key</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="o">&gt;</span><span class="nx">First</span> <span class="nx">item</span><span class="o">&lt;</span><span class="err">/li&gt;,</span>
    <span class="o">&lt;</span><span class="nx">li</span> <span class="nx">key</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="o">&gt;</span><span class="nx">Second</span> <span class="nx">item</span><span class="o">&lt;</span><span class="err">/li&gt;,</span>
    <span class="o">&lt;</span><span class="nx">li</span> <span class="nx">key</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="o">&gt;</span><span class="nx">Third</span> <span class="nx">item</span><span class="o">&lt;</span><span class="err">/li&gt;,</span>
  <span class="p">];</span>
<span class="p">}</span>
</code></pre></div>
<p>In the future, we&#39;ll likely add a special fragment syntax to JSX that doesn&#39;t require keys.</p>

<p>We&#39;ve added support for returning strings, too:</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="s1">&#39;Look ma, no spans!&#39;</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p><a href="/react/docs/react-component.html#render">See the full list of supported return types</a>.</p>

<h3>Better error handling</h3>

<p>Previously, runtime errors during rendering could put React in a broken state, producing cryptic error messages and requiring a page refresh to recover. To address this problem, React 16 uses a more resilient error-handling strategy. By default, if an error is thrown inside a component&#39;s render or lifecycle methods, the whole component tree is unmounted from the root. This prevents the display of corrupted data. However, it&#39;s probably not the ideal user experience.</p>

<p>Instead of unmounting the whole app every time there&#39;s an error, you can use error boundaries. Error boundaries are special components that capture errors inside their subtree and display a fallback UI in its place. Think of error boundaries like try-catch statements, but for React components.</p>

<p>For more details, check out our <a href="/react/blog/2017/07/26/error-handling-in-react-16.html">previous post on error handling in React 16</a>.</p>

<h3>Portals</h3>

<p>Portals provide a first-class way to render children into a DOM node that exists outside the DOM hierarchy of the parent component.</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// React does *not* create a new div. It renders the children into `domNode`.</span>
  <span class="c1">// `domNode` is any valid DOM node, regardless of its location in the DOM.</span>
  <span class="k">return</span> <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">createPortal</span><span class="p">(</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">children</span><span class="p">,</span>
    <span class="nx">domNode</span><span class="p">,</span>
  <span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>See a full example in the <a href="/react/docs/portals.html">documentation for portals</a>.</p>

<h3>Better server-side rendering</h3>

<p>React 16 includes a completely rewritten server renderer. It&#39;s really fast. It supports <strong>streaming</strong>, so you can start sending bytes to the client faster. And thanks to a <a href="#reduced-file-size">new packaging strategy</a> that compiles away <code>process.env</code> checks (Believe it or not, reading <code>process.env</code> in Node is really slow!), you no longer need to bundle React to get good server-rendering performance.</p>

<p>Core team member Sasha Aickin wrote a <a href="https://medium.com/@aickin/whats-new-with-server-side-rendering-in-react-16-9b0d78585d67">great article describing React 16&#39;s SSR improvements</a>. According to Sasha&#39;s synthetic benchmarks, server rendering in React 16 is roughly <strong>three times faster</strong> than React 15. &quot;When comparing against React 15 with <code>process.env</code> compiled out, there’s about a 2.4x improvement in Node 4, about a 3x performance improvement in Node 6, and a full 3.8x improvement in the new Node 8.4 release. And if you compare against React 15 without compilation, React 16 has a full order of magnitude gain in SSR in the latest version of Node!&quot; (As Sasha points out, please be aware that these numbers are based on synthetic benchmarks and may not reflect real-world performance.)</p>

<p>In addition, React 16 is better at hydrating server-rendered HTML once it reaches the client. It no longer requires the initial render to exactly match the result from the server. Instead, it will attempt to reuse as much of the existing DOM as possible. No more checksums! In general, we don&#39;t recommend that you render different content on the client versus the server, but it can be useful in some cases (e.g. timestamps).</p>

<p>See the <a href="/react/docs/react-dom-server.html">documentation for <code>ReactDOMServer</code></a> for more details.</p>

<h3>Support for custom DOM attributes</h3>

<p>Instead of ignoring unrecognized HTML and SVG attributes, React will now <a href="https://facebook.github.io/react/blog/2017/09/08/dom-attributes-in-react-16.html">pass them through to the DOM</a>. This has the added benefit of allowing us to get rid of most of React&#39;s attribute whitelist, resulting in reduced file sizes.</p>

<h3>Reduced file size</h3>

<p>Despite all these additions, React 16 is actually <strong>smaller</strong> compared to 15.6.1!</p>

<ul>
<li><code>react</code> is 5.3 kb (2.2 kb gzipped), down from 20.7 kb (6.9 kb gzipped).</li>
<li><code>react-dom</code> is 103.7 kb (32.6 kb gzipped), down from 141 kb (42.9 kb gzipped).</li>
<li><code>react</code> + <code>react-dom</code> is 109 kb (34.8 kb gzipped), down from 161.7 kb (49.8 kb gzipped).</li>
</ul>

<p>That amounts to a combined <strong>32% size decrease compared to the previous version (30% post-gzip)</strong>.</p>

<p>The size difference is partly attributable to a change in packaging. React now uses <a href="https://rollupjs.org/">Rollup</a> to create flat bundles for each of its different target formats, resulting in both size and runtime performance wins. The flat bundle format also means that React&#39;s impact on bundle size is roughly consistent regardless of how your ship your app, whether it&#39;s with Webpack, Browserify, the pre-built UMD bundles, or any other system.</p>

<h3>MIT licensed</h3>

<p><a href="https://code.facebook.com/posts/300798627056246/relicensing-react-jest-flow-and-immutable-js/">In case you missed it</a>, React 16 is available under the MIT license. We&#39;ve also published React 15.6.2 under MIT, for those who are unable to upgrade immediately.</p>

<h3>New core architecture</h3>

<p>React 16 is the first version of React built on top of a new core architecture, codenamed &quot;Fiber.&quot; You can read all about this project over on <a href="https://code.facebook.com/posts/1716776591680069/react-16-a-look-inside-an-api-compatible-rewrite-of-our-frontend-ui-library/">Facebook&#39;s engineering blog</a>. (Spoiler: we rewrote React!)</p>

<p>Fiber is responsible for most of the new features in React 16, like error boundaries and fragments. Over the next few releases, you can expect more new features as we begin to unlock the full potential of React.</p>

<p>Perhaps the most exciting area we&#39;re working on is <strong>async rendering</strong>—a strategy for cooperatively scheduling rendering work by periodically yielding execution to the browser. The upshot is that, with async rendering, apps are more responsive because React avoids blocking the main thread.</p>

<p>This demo provides an early peek at the types of problems async rendering can solve:</p>

<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">Ever wonder what &quot;async rendering&quot; means? Here&#39;s a demo of how to coordinate an async React tree with non-React work <a href="https://t.co/3snoahB3uV">https://t.co/3snoahB3uV</a> <a href="https://t.co/egQ988gBjR">pic.twitter.com/egQ988gBjR</a></p>&mdash; Andrew Clark (@acdlite) <a href="https://twitter.com/acdlite/status/909926793536094209">September 18, 2017</a></blockquote>

<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<p><em>Tip: Pay attention to the spinning black square.</em></p>

<p>We think async rendering is a big deal, and represents the future of React. To make migration to v16.0 as smooth as possible, we&#39;re not enabling any async features yet, but we&#39;re excited to start rolling them out in the coming months. Stay tuned!</p>

<h2>Installation</h2>

<p>React v16.0.0 is available on the npm registry.</p>

<p>To install React 16 with Yarn, run:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">yarn add react@^16.0.0 react-dom@^16.0.0
</code></pre></div>
<p>To install React 16 with npm, run:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">npm install --save react@^16.0.0 react-dom@^16.0.0
</code></pre></div>
<p>We also provide UMD builds of React via a CDN:</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;script </span><span class="na">crossorigin</span> <span class="na">src=</span><span class="s">&quot;https://unpkg.com/react@16/umd/react.production.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">crossorigin</span> <span class="na">src=</span><span class="s">&quot;https://unpkg.com/react-dom@16/umd/react-dom.production.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</code></pre></div>
<p>Refer to the documentation for <a href="/react/docs/installation.html">detailed installation instructions</a>.</p>

<h2>Upgrading</h2>

<p>Although React 16 includes significant internal changes, in terms of upgrading, you can think of this like any other major React release. We&#39;ve been serving React 16 to Facebook and Messenger.com users since earlier this year, and we released several beta and release candidate versions to flush out additional issues. With minor exceptions, <strong>if your app runs in 15.6 without any warnings, it should work in 16.</strong></p>

<h3>New deprecations</h3>

<p>Hydrating a server-rendered container now has an explicit API. If you&#39;re reviving server-rendered HTML, use <a href="/react/docs/react-dom.html#hydrate"><code>ReactDOM.hydrate</code></a> instead of <code>ReactDOM.render</code>. Keep using <code>ReactDOM.render</code> if you&#39;re just doing client-side rendering.</p>

<h3>React Addons</h3>

<p>As previously announced, we&#39;ve <a href="/react/blog/2017/04/07/react-v15.5.0.html#discontinuing-support-for-react-addons">discontinued support for React Addons</a>. We expect the latest version of each addon (except <code>react-addons-perf</code>; see below) to work for the foreseeable future, but we won&#39;t publish additional updates.</p>

<p>Refer to the previous announcement for <a href="/react/blog/2017/04/07/react-v15.5.0.html#discontinuing-support-for-react-addons">suggestions on how to migrate</a>.</p>

<p><code>react-addons-perf</code> no longer works at all in React 16. It&#39;s likely that we&#39;ll release a new version of this tool in the future. In the meantime, you can <a href="/react/docs/optimizing-performance.html#profiling-components-with-the-chrome-performance-tab">use your browser&#39;s performance tools to profile React components</a>.</p>

<h3>Breaking changes</h3>

<p>React 16 includes a number of small breaking changes. These only affect uncommon use cases and we don&#39;t expect them to break most apps.</p>

<ul>
<li>React 15 had limited, undocumented support for error boundaries using <code>unstable_handleError</code>. This method has been renamed to <code>componentDidCatch</code>. You can use a codemod to <a href="https://github.com/reactjs/react-codemod#error-boundaries">automatically migrate to the new API</a>.</li>
<li><code>ReactDOM.render</code> and <code>ReactDOM.unstable_renderIntoContainer</code> now return null if called from inside a lifecycle method. To work around this, you can use <a href="https://github.com/facebook/react/issues/10309#issuecomment-318433235">portals</a> or <a href="https://github.com/facebook/react/issues/10309#issuecomment-318434635">refs</a>.</li>
<li><code>setState</code>:

<ul>
<li>Calling <code>setState</code> with null no longer triggers an update. This allows you to decide in an updater function if you want to re-render.</li>
<li>Calling <code>setState</code> directly in render always causes an update. This was not previously the case. Regardless, you should not be calling setState from render.</li>
<li><code>setState</code> callbacks (second argument) now fire immediately after <code>componentDidMount</code> / <code>componentDidUpdate</code> instead of after all components have rendered.</li>
</ul></li>
<li>When replacing <code>&lt;A /&gt;</code> with <code>&lt;B /&gt;</code>,  <code>B.componentWillMount</code> now always happens before  <code>A.componentWillUnmount</code>. Previously, <code>A.componentWillUnmount</code> could fire first in some cases.</li>
<li>Previously, changing the ref to a component would always detach the ref before that component&#39;s render is called. Now, we change the ref later, when applying the changes to the DOM.</li>
<li>It is not safe to re-render into a container that was modified by something other than React. This worked previously in some cases but was never supported. We now emit a warning in this case. Instead you should clean up your component trees using <code>ReactDOM.unmountComponentAtNode</code>. <a href="https://github.com/facebook/react/issues/10294#issuecomment-318820987">See this example.</a></li>
<li><code>componentDidUpdate</code> lifecycle no longer receives <code>prevContext</code> param. (See <a href="https://github.com/facebook/react/issues/8631">#8631</a>)</li>
<li>Shallow renderer no longer calls <code>componentDidUpdate</code> because DOM refs are not available. This also makes it consistent with <code>componentDidMount</code> (which does not get called in previous versions either).</li>
<li>Shallow renderer does not implement <code>unstable_batchedUpdates</code> anymore.</li>
</ul>

<h3>Packaging</h3>

<ul>
<li>There is no <code>react/lib/*</code> and <code>react-dom/lib/*</code> anymore. Even in CommonJS environments, React and ReactDOM are precompiled to single files (“flat bundles”). If you previously relied on undocumented React internals, and they don’t work anymore, let us know about your specific case in a new issue, and we’ll try to figure out a migration strategy for you.</li>
<li>There is no <code>react-with-addons.js</code> build anymore. All compatible addons are published separately on npm, and have single-file browser versions if you need them.</li>
<li>The deprecations introduced in 15.x have been removed from the core package. <code>React.createClass</code> is now available as <code>create-react-class</code>, <code>React.PropTypes</code> as <code>prop-types</code>, <code>React.DOM</code> as <code>react-dom-factories</code>, <code>react-addons-test-utils</code> as <code>react-dom/test-utils</code>, and shallow renderer as <code>react-test-renderer/shallow</code>. See <a href="https://facebook.github.io/react/blog/2017/04/07/react-v15.5.0.html">15.5.0</a> and <a href="https://facebook.github.io/react/blog/2017/06/13/react-v15.6.0.html">15.6.0</a> blog posts for instructions on migrating code and automated codemods.</li>
<li>The names and paths to the single-file browser builds have changed to emphasize the difference between development and production builds. For example:

<ul>
<li><code>react/dist/react.js</code> → <code>react/umd/react.development.js</code></li>
<li><code>react/dist/react.min.js</code> → <code>react/umd/react.production.min.js</code></li>
<li><code>react-dom/dist/react-dom.js</code> → <code>react-dom/umd/react-dom.development.js</code></li>
<li><code>react-dom/dist/react-dom.min</code>.js → <code>react-dom/umd/react-dom.production.min.js</code></li>
</ul></li>
</ul>

<h2>JavaScript Environment Requirements</h2>

<p>React 16 depends on the collection types <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map">Map</a> and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set">Set</a>. If you support older browsers and devices which may not yet provide these natively (e.g. IE &lt; 11), consider including a global polyfill in your bundled application, such as <a href="https://github.com/zloirock/core-js">core-js</a> or <a href="https://babeljs.io/docs/usage/polyfill/">babel-polyfill</a>.</p>

<p>A polyfilled environment for React 16 using core-js to support older browsers might look like:</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="s1">&#39;core-js/es6/map&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="s1">&#39;core-js/es6/set&#39;</span><span class="p">;</span>

<span class="kr">import</span> <span class="nx">React</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">ReactDOM</span> <span class="nx">from</span> <span class="s1">&#39;react-dom&#39;</span><span class="p">;</span>

<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span>
  <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Hello</span><span class="p">,</span> <span class="nx">world</span><span class="o">!&lt;</span><span class="err">/h1&gt;,</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;root&#39;</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div>
<p>React also depends on <code>requestAnimationFrame</code> (even in test environments). A simple shim for test environments would be:</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">global</span><span class="p">.</span><span class="nx">requestAnimationFrame</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">};</span>
</code></pre></div>
<h2>Acknowledgments</h2>

<p>As always, this release would not have been possible without our open source contributors. Thanks to everyone who filed bugs, opened PRs, responded to issues, wrote documentation, and more!</p>

<p>Special thanks to our core contributors, especially for their heroic efforts over the past few weeks during the prerelease cycle: <a href="https://twitter.com/aweary">Brandon Dail</a>, <a href="https://twitter.com/monasticpanic">Jason Quense</a>, <a href="https://twitter.com/natehunzaker">Nathan Hunzaker</a>, and <a href="https://twitter.com/xander76">Sasha Aickin</a>.</p>

</div>



      </div>
    
      <div class="post-list-item">
        

<h1>

  <a href="/react/blog/2017/09/25/react-v15.6.2.html">React v15.6.2</a>

</h1>

<p class="meta">
  September 25, 2017
  by
  
    
      <a href="https://github.com/nhunzaker">Nathan Hunzaker</a>
    
    
  
</p>

<hr>

<div class="post">
  <p>Today we&#39;re sending out React 15.6.2. In 15.6.1, we shipped a few fixes for change events and inputs that had some unintended consequences. Those regressions have been ironed out, and we&#39;ve also included a few more fixes to improve the stability of React across all browsers.</p>

<p>Additionally, 15.6.2 adds support for the <a href="https://developers.google.com/web/updates/2017/03/chrome-58-media-updates#controlslist"><code>controlList</code></a> attribute, and CSS columns are no longer appended with a <code>px</code> suffix.</p>

<h2>Installation</h2>

<p>We recommend using <a href="https://yarnpkg.com/">Yarn</a> or <a href="https://www.npmjs.com/">npm</a> for managing front-end dependencies. If you&#39;re new to package managers, the <a href="https://yarnpkg.com/en/docs/getting-started">Yarn documentation</a> is a good place to get started.</p>

<p>To install React with Yarn, run:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">yarn add react@^15.6.2 react-dom@^15.6.2
</code></pre></div>
<p>To install React with npm, run:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">npm install --save react@^15.6.2 react-dom@^15.6.2
</code></pre></div>
<p>We recommend using a bundler like <a href="https://webpack.js.org/">webpack</a> or <a href="http://browserify.org/">Browserify</a> so you can write modular code and bundle it together into small packages to optimize load time.</p>

<p>Remember that by default, React runs extra checks and provides helpful warnings in development mode. When deploying your app, make sure to <a href="/react/docs/optimizing-performance.html#use-the-production-build">use the production build</a>.</p>

<p>In case you don&#39;t use a bundler, we also provide pre-built bundles in the npm packages which you can <a href="/react/docs/installation.html#using-a-cdn">include as script tags</a> on your page:</p>

<ul>
<li><strong>React</strong><br/>
Dev build with warnings: <a href="https://unpkg.com/react@15.6.2/dist/react.js">react/dist/react.js</a><br/>
Minified build for production: <a href="https://unpkg.com/react@15.6.2/dist/react.min.js">react/dist/react.min.js</a><br/></li>
<li><strong>React with Add-Ons</strong><br/>
Dev build with warnings: <a href="https://unpkg.com/react@15.6.2/dist/react-with-addons.js">react/dist/react-with-addons.js</a><br/>
Minified build for production: <a href="https://unpkg.com/react@15.5.0/dist/react-with-addons.min.js">react/dist/react-with-addons.min.js</a><br/></li>
<li><strong>React DOM</strong> (include React in the page before React DOM)<br/>
Dev build with warnings: <a href="https://unpkg.com/react-dom@15.6.2/dist/react-dom.js">react-dom/dist/react-dom.js</a><br/>
Minified build for production: <a href="https://unpkg.com/react-dom@15.6.2/dist/react-dom.min.js">react-dom/dist/react-dom.min.js</a><br/></li>
<li><strong>React DOM Server</strong> (include React in the page before React DOM Server)<br/>
Dev build with warnings: <a href="https://unpkg.com/react-dom@15.6.2/dist/react-dom-server.js">react-dom/dist/react-dom-server.js</a><br/>
Minified build for production: <a href="https://unpkg.com/react-dom@15.6.2/dist/react-dom-server.min.js">react-dom/dist/react-dom-server.min.js</a><br/></li>
</ul>

<p>We&#39;ve also published version <code>15.6.2</code> of <code>react</code> and <code>react-dom</code> on npm, and the <code>react</code> package on bower.</p>

<hr>

<h2>Changelog</h2>

<h2>15.6.2 (September 25, 2017)</h2>

<h3>All Packages</h3>

<ul>
<li>Switch from BSD + Patents to MIT license</li>
</ul>

<h3>React DOM</h3>

<ul>
<li>Fix a bug where modifying <code>document.documentMode</code> would trigger IE detection in other browsers, breaking change events. (<a href="https://github.com/aweary">@aweary</a> in <a href="https://github.com/facebook/react/pull/10032">#10032</a>)</li>
<li>CSS Columns are treated as unitless numbers. (<a href="https://github.com/aweary">@aweary</a> in <a href="https://github.com/facebook/react/pull/10115">#10115</a>)</li>
<li>Fix bug in QtWebKit when wrapping synthetic events in proxies. (<a href="https://github.com/walrusfruitcake">@walrusfruitcake</a> in <a href="https://github.com/facebook/react/pull/10011">#10115</a>)</li>
<li>Prevent event handlers from receiving extra argument in development. (<a href="https://github.com/aweary">@aweary</a> in <a href="https://github.com/facebook/react/pull/8363">#10115</a>)</li>
<li>Fix cases where <code>onChange</code> would not fire with <code>defaultChecked</code> on radio inputs. (<a href="https://github.com/jquense">@jquense</a> in <a href="https://github.com/facebook/react/pull/10156">#10156</a>)</li>
<li>Add support for <code>controlList</code> attribute to DOM property whitelist (<a href="https://github.com/nhunzaker">@nhunzaker</a> in <a href="https://github.com/facebook/react/pull/9940">#9940</a>)</li>
<li>Fix a bug where creating an element with a ref in a constructor did not throw an error in development. (<a href="https://github.com/iansu">@iansu</a> in <a href="https://github.com/facebook/react/pull/10025">#10025</a>)</li>
</ul>

</div>



      </div>
    
      <div class="post-list-item">
        

<h1>

  <a href="/react/blog/2017/09/08/dom-attributes-in-react-16.html">DOM Attributes in React 16</a>

</h1>

<p class="meta">
  September  8, 2017
  by
  
    
      <a href="https://twitter.com/dan_abramov">Dan Abramov</a>
    
    
  
</p>

<hr>

<div class="post">
  <p>In the past, React used to ignore unknown DOM attributes. If you wrote JSX with an attribute that React doesn&#39;t recognize, React would just skip it. For example, this:</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">// Your code:</span>
<span class="o">&lt;</span><span class="nx">div</span> <span class="nx">mycustomattribute</span><span class="o">=</span><span class="s2">&quot;something&quot;</span> <span class="o">/&gt;</span>
</code></pre></div>
<p>would render an empty div to the DOM with React 15:</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">// React 15 output:</span>
<span class="o">&lt;</span><span class="nx">div</span> <span class="o">/&gt;</span>
</code></pre></div>
<p>In React 16, we are making a change. Now, any unknown attributes will end up in the DOM:</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">// React 16 output:</span>
<span class="o">&lt;</span><span class="nx">div</span> <span class="nx">mycustomattribute</span><span class="o">=</span><span class="s2">&quot;something&quot;</span> <span class="o">/&gt;</span>
</code></pre></div>
<h2>Why Are We Changing This?</h2>

<p>React has always provided a JavaScript-centric API to the DOM. Since React components often take both custom and DOM-related props, it makes sense for React to use the <code>camelCase</code> convention just like the DOM APIs:</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="o">&lt;</span><span class="nx">div</span> <span class="nx">tabIndex</span><span class="o">=</span><span class="s2">&quot;-1&quot;</span> <span class="o">/&gt;</span>
</code></pre></div>
<p>This has not changed. However, the way we enforced it in the past forced us to maintain a whitelist of all valid React DOM attributes in the bundle:</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">// ...</span>
<span class="nx">summary</span><span class="o">:</span> <span class="s1">&#39;summary&#39;</span><span class="p">,</span>
<span class="nx">tabIndex</span><span class="o">:</span> <span class="s1">&#39;tabindex&#39;</span>
<span class="nx">target</span><span class="o">:</span> <span class="s1">&#39;target&#39;</span><span class="p">,</span>
<span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;title&#39;</span><span class="p">,</span>
<span class="c1">// ...</span>
</code></pre></div>
<p>This had two downsides:</p>

<ul>
<li><p>You could not <a href="https://github.com/facebook/react/issues/140">pass a custom attribute</a>. This is useful for supplying browser-specific non-standard attributes, trying new DOM APIs, and integrating with opinionated third-party libraries.</p></li>
<li><p>The attribute list kept growing over time, but most React canonical attribute names are already valid in the DOM. Removing most of the whitelist helped us reduce the bundle size a little bit.</p></li>
</ul>

<p>With the new approach, both of these problems are solved. With React 16, you can now pass custom attributes to all HTML and SVG elements, and React doesn&#39;t have to include the whole attribute whitelist in the production version.</p>

<p><strong>Note that you should still use the canonical React naming for known attributes:</strong></p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">// Yes, please</span>
<span class="o">&lt;</span><span class="nx">div</span> <span class="nx">tabIndex</span><span class="o">=</span><span class="s2">&quot;-1&quot;</span> <span class="o">/&gt;</span>

<span class="c1">// Warning: Invalid DOM property `tabindex`. Did you mean `tabIndex`?</span>
<span class="o">&lt;</span><span class="nx">div</span> <span class="nx">tabindex</span><span class="o">=</span><span class="s2">&quot;-1&quot;</span> <span class="o">/&gt;</span>
</code></pre></div>
<p>In other words, the way you use DOM components in React hasn&#39;t changed, but now you have some new capabilities.</p>

<h2>Should I Keep Data in Custom Attributes?</h2>

<p>No. We don&#39;t encourage you to keep data in DOM attributes. Even if you have to, <code>data-</code> attributes are probably a better approach, but in most cases data should be kept in React component state or external stores.</p>

<p>However, the new feature is handy if you need to use a non-standard or a new DOM attribute, or if you need to integrate with a third-party library that relies on such attributes.</p>

<h2>Data and ARIA Attributes</h2>

<p>Just like before, React lets you pass <code>data-</code> and <code>aria-</code> attributes freely:</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="o">&lt;</span><span class="nx">div</span> <span class="nx">data</span><span class="o">-</span><span class="nx">foo</span><span class="o">=</span><span class="s2">&quot;42&quot;</span> <span class="o">/&gt;</span>
<span class="o">&lt;</span><span class="nx">button</span> <span class="nx">aria</span><span class="o">-</span><span class="nx">label</span><span class="o">=</span><span class="s2">&quot;Close&quot;</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">onClose</span><span class="p">}</span> <span class="o">/&gt;</span>
</code></pre></div>
<p>This has not changed.</p>

<p><a href="/react/docs/accessibility.html">Accessibility</a> is very important, so even though React 16 passes any attributes through, it still validates that <code>aria-</code> props have correct names in development mode, just like React 15 did.</p>

<h2>Migration Path</h2>

<p>We have included <a href="/react/warnings/unknown-prop.html">a warning about unknown attributes</a> since <a href="https://github.com/facebook/react/releases/tag/v15.2.0">React 15.2.0</a> which came out more than a year ago. The vast majority of third-party libraries have already updated their code. If your app doesn&#39;t produce warnings with React 15.2.0 or higher, this change should not require modifications in your application code.</p>

<p>If you still accidentally forward non-DOM props to DOM components, with React 16 you will start seeing those attributes in the DOM, for example:</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="o">&lt;</span><span class="nx">div</span> <span class="nx">myData</span><span class="o">=</span><span class="s1">&#39;[Object object]&#39;</span> <span class="o">/&gt;</span>
</code></pre></div>
<p>This is somewhat safe (the browser will just ignore them) but we recommend to fix these cases when you see them. One potential hazard is if you pass an object that implements a custom <code>toString()</code> or <code>valueOf()</code> method that throws. Another possible issue is that legacy HTML attributes like <code>align</code> and <code>valign</code> will now be passed to the DOM. They used to be stripped out because React didn&#39;t support them.</p>

<p>To avoid these problems, we suggest to fix the warnings you see in React 15 before upgrading to React 16.</p>

<h2>Changes in Detail</h2>

<p>We&#39;ve made a few other changes to make the behavior more predictable and help ensure you&#39;re not making mistakes. We don&#39;t anticipate that these changes are likely to break real-world applications.</p>

<p><strong>These changes only affect DOM components like <code>&lt;div&gt;</code>, not your own components.</strong>  </p>

<p>Below is a detailed list of them.</p>

<ul>
<li><p><strong>Unknown attributes with string, number, and object values:</strong>  </p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="o">&lt;</span><span class="nx">div</span> <span class="nx">mycustomattribute</span><span class="o">=</span><span class="s2">&quot;value&quot;</span> <span class="o">/&gt;</span>
<span class="o">&lt;</span><span class="nx">div</span> <span class="nx">mycustomattribute</span><span class="o">=</span><span class="p">{</span><span class="mi">42</span><span class="p">}</span> <span class="o">/&gt;</span>
<span class="o">&lt;</span><span class="nx">div</span> <span class="nx">mycustomattribute</span><span class="o">=</span><span class="p">{</span><span class="nx">myObject</span><span class="p">}</span> <span class="o">/&gt;</span>
</code></pre></div>
<p>React 15: Warns and ignores them.<br>
React 16: Converts values to strings and passes them through.</p>

<p><em>Note: attributes starting with <code>on</code> are not passed through as an exception because this could become a potential security hole.</em></p></li>
<li><p><strong>Known attributes with a different canonical React name:</strong>  </p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="o">&lt;</span><span class="nx">div</span> <span class="nx">tabindex</span><span class="o">=</span><span class="s2">&quot;-1&quot;</span> <span class="o">/&gt;</span>
<span class="o">&lt;</span><span class="nx">div</span> <span class="kr">class</span><span class="o">=</span><span class="s2">&quot;hi&quot;</span> <span class="o">/&gt;</span>
</code></pre></div>
<p>React 15: Warns and ignores them.<br>
React 16: Warns but converts values to strings and passes them through.</p>

<p><em>Note: always use the canonical React naming for all supported attributes.</em></p></li>
<li><p><strong>Non-boolean attributes with boolean values:</strong>  </p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="p">{</span><span class="kc">false</span><span class="p">}</span> <span class="o">/&gt;</span>
</code></pre></div>
<p>React 15: Converts booleans to strings and passes them through.<br>
React 16: Warns and ignores them.</p></li>
<li><p><strong>Non-event attributes with function values:</strong>  </p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="p">{</span><span class="kd">function</span><span class="p">()</span> <span class="p">{}}</span> <span class="o">/&gt;</span>
</code></pre></div>
<p>React 15: Converts functions to strings and passes them through.<br>
React 16: Warns and ignores them.</p></li>
<li><p><strong>Attributes with Symbol values:</strong></p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="p">{</span><span class="nx">Symbol</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">)}</span> <span class="o">/&gt;</span>
</code></pre></div>
<p>React 15: Crashes.<br>
React 16: Warns and ignores them.</p></li>
<li><p><strong>Attributes with <code>NaN</code> values:</strong></p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="o">&lt;</span><span class="nx">div</span> <span class="nx">tabIndex</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span> <span class="o">/</span> <span class="mi">0</span><span class="p">}</span> <span class="o">/&gt;</span>
</code></pre></div>
<p>React 15: Converts <code>NaN</code>s to strings and passes them through.<br>
React 16: Warns and ignores them.</p></li>
</ul>

<p>While testing this release, we have also <a href="https://github.com/facebook/react/blob/master/fixtures/attribute-behavior/AttributeTableSnapshot.md">created an automatically generated table</a> for all known attributes to track potential regressions.</p>

<h2>Try It!</h2>

<p>You can try the change in <a href="https://codepen.io/gaearon/pen/gxNVdP?editors=0010">this CodePen</a>.<br>
It uses React 16 RC, and you can <a href="https://github.com/facebook/react/issues/10294">help us by testing the RC in your project!</a></p>

<h2>Thanks</h2>

<p>This effort was largely driven by <a href="https://github.com/nhunzaker">Nathan Hunzaker</a> who has been a <a href="https://github.com/facebook/react/pulls?q=is%3Apr+author%3Anhunzaker+is%3Aclosed">prolific outside contributor to React</a>.</p>

<p>You can find his work on this issue in several PRs over the course of last year: <a href="https://github.com/facebook/react/pull/6459">#6459</a>, <a href="https://github.com/facebook/react/pull/7311">#7311</a>, <a href="https://github.com/facebook/react/pull/10229">#10229</a>, <a href="https://github.com/facebook/react/pull/10397">#10397</a>, <a href="https://github.com/facebook/react/pull/10385">#10385</a>, and <a href="https://github.com/facebook/react/pull/10470">#10470</a>.</p>

<p>Major changes in a popular project can take a lot of time and research. Nathan demonstrated perseverance and commitment to getting this change through, and we are very thankful to him for this and other efforts.</p>

<p>We would also like to thank <a href="https://github.com/aweary">Brandon Dail</a> and <a href="https://github.com/jquense">Jason Quense</a> for their invaluable help maintaining React this year.</p>

<h2>Future Work</h2>

<p>We are not changing how <a href="https://developer.mozilla.org/en-US/docs/Web/Web_Components/Custom_Elements">custom elements</a> work in React 16, but there are <a href="https://github.com/facebook/react/issues/7249">existing discussions</a> about setting properties instead of attributes, and we might revisit this in React 17. Feel free to chime in if you&#39;d like to help!</p>

</div>



      </div>
    
      <div class="post-list-item">
        

<h1>

  <a href="/react/blog/2017/07/26/error-handling-in-react-16.html">Error Handling in React 16</a>

</h1>

<p class="meta">
  July 26, 2017
  by
  
    
      <a href="https://twitter.com/dan_abramov">Dan Abramov</a>
    
    
  
</p>

<hr>

<div class="post">
  <p>As React 16 release is getting closer, we would like to announce a few changes to how React handles JavaScript errors inside components. These changes are included in React 16 beta versions, and will be a part of React 16.</p>

<p><strong>By the way, <a href="https://github.com/facebook/react/issues/10294">we just released the first beta of React 16 for you to try!</a></strong></p>

<h2>Behavior in React 15 and Earlier</h2>

<p>In the past, JavaScript errors inside components used to corrupt React’s internal state and cause it to <a href="https://github.com/facebook/react/issues/4026">emit</a> <a href="https://github.com/facebook/react/issues/6895">cryptic</a> <a href="https://github.com/facebook/react/issues/8579">errors</a> on next renders. These errors were always caused by an earlier error in the application code, but React did not provide a way to handle them gracefully in components, and could not recover from them.</p>

<h2>Introducing Error Boundaries</h2>

<p>A JavaScript error in a part of the UI shouldn’t break the whole app. To solve this problem for React users, React 16 introduces a new concept of an “error boundary”.</p>

<p>Error boundaries are React components that <strong>catch JavaScript errors anywhere in their child component tree, log those errors, and display a fallback UI</strong> instead of the component tree that crashed. Error boundaries catch errors during rendering, in lifecycle methods, and in constructors of the whole tree below them.</p>

<p>A class component becomes an error boundary if it defines a new lifecycle method called <code>componentDidCatch(error, info)</code>:</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kr">class</span> <span class="nx">ErrorBoundary</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">hasError</span><span class="o">:</span> <span class="kc">false</span> <span class="p">};</span>
  <span class="p">}</span>

<span class="hll">  <span class="nx">componentDidCatch</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">info</span><span class="p">)</span> <span class="p">{</span>
</span><span class="hll">    <span class="c1">// Display fallback UI</span>
</span><span class="hll">    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="nx">hasError</span><span class="o">:</span> <span class="kc">true</span> <span class="p">});</span>
</span><span class="hll">    <span class="c1">// You can also log the error to an error reporting service</span>
</span><span class="hll">    <span class="nx">logErrorToMyService</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">info</span><span class="p">);</span>
</span><span class="hll">  <span class="p">}</span>
</span>
  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
<span class="hll">    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">hasError</span><span class="p">)</span> <span class="p">{</span>
</span><span class="hll">      <span class="c1">// You can render any custom fallback UI</span>
</span><span class="hll">      <span class="k">return</span> <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Something</span> <span class="nx">went</span> <span class="nx">wrong</span><span class="p">.</span><span class="o">&lt;</span><span class="err">/h1&gt;;</span>
</span><span class="hll">    <span class="p">}</span>
</span>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">children</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Then you can use it as a regular component:</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="o">&lt;</span><span class="nx">ErrorBoundary</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nx">MyWidget</span> <span class="o">/&gt;</span>
<span class="o">&lt;</span><span class="err">/ErrorBoundary&gt;</span>
</code></pre></div>
<p>The <code>componentDidCatch()</code> method works like a JavaScript <code>catch {}</code> block, but for components. Only class components can be error boundaries. In practice, most of the time you’ll want to declare an error boundary component once and use it throughout your application.</p>

<p>Note that <strong>error boundaries only catch errors in the components below them in the tree</strong>. An error boundary can’t catch an error within itself. If an error boundary fails trying to render the error message, the error will propagate to the closest error boundary above it. This, too, is similar to how <code>catch {}</code> block works in JavaScript.</p>

<h2>Live Demo</h2>

<p>Check out <a href="https://codepen.io/gaearon/pen/wqvxGa?editors=0010">this example of declaring and using an error boundary</a> with <a href="https://github.com/facebook/react/issues/10294">React 16 beta</a>.</p>

<h2>Where to Place Error Boundaries</h2>

<p>The granularity of error boundaries is up to you. You may wrap top-level route components to display a “Something went wrong” message to the user, just like server-side frameworks often handle crashes. You may also wrap individual widgets in an error boundary to protect them from crashing the rest of the application.</p>

<h2>New Behavior for Uncaught Errors</h2>

<p>This change has an important implication. <strong>As of React 16, errors that were not caught by any error boundary will result in unmounting of the whole React component tree.</strong></p>

<p>We debated this decision, but in our experience it is worse to leave corrupted UI in place than to completely remove it. For example, in a product like Messenger leaving the broken UI visible could lead to somebody sending a message to the wrong person. Similarly, it is worse for a payments app to display a wrong amount than to render nothing.</p>

<p>This change means that as you migrate to React 16, you will likely uncover existing crashes in your application that have been unnoticed before. Adding error boundaries lets you provide better user experience when something goes wrong.</p>

<p>For example, Facebook Messenger wraps content of the sidebar, the info panel, the conversation log, and the message input into separate error boundaries. If some component in one of these UI areas crashes, the rest of them remain interactive.</p>

<p>We also encourage you to use JS error reporting services (or build your own) so that you can learn about unhandled exceptions as they happen in production, and fix them.</p>

<h2>Component Stack Traces</h2>

<p>React 16 prints all errors that occurred during rendering to the console in development, even if the application accidentally swallows them. In addition to the error message and the JavaScript stack, it also provides component stack traces. Now you can see where exactly in the component tree the failure has happened:</p>

<p><img src="/react/img/blog/error-boundaries-stack-trace.png" alt="Component stack traces in error message" style="width: 100%;"></p>

<p>You can also see the filenames and line numbers in the component stack trace. This works by default in <a href="https://github.com/facebookincubator/create-react-app">Create React App</a> projects:</p>

<p><img src="/react/img/blog/error-boundaries-stack-trace-line-numbers.png" alt="Component stack traces with line numbers in error message" style="width: 100%;"></p>

<p>If you don’t use Create React App, you can add <a href="https://www.npmjs.com/package/babel-plugin-transform-react-jsx-source">this plugin</a> manually to your Babel configuration. Note that it’s intended only for development and <strong>must be disabled in production</strong>.</p>

<h2>Why Not Use <code>try</code> / <code>catch</code>?</h2>

<p><code>try</code> / <code>catch</code> is great but it only works for imperative code:</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="k">try</span> <span class="p">{</span>
  <span class="nx">showButton</span><span class="p">();</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div>
<p>However, React components are declarative and specify <em>what</em> should be rendered:</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="o">&lt;</span><span class="nx">Button</span> <span class="o">/&gt;</span>
</code></pre></div>
<p>Error boundaries preserve the declarative nature of React, and behave as you would expect. For example, even if an error occurs in a <code>componentDidUpdate</code> hook caused by a <code>setState</code> somewhere deep in the tree, it will still correctly propagate to the closest error boundary.</p>

<h2>Naming Changes from React 15</h2>

<p>React 15 included a very limited support for error boundaries under a different method name: <code>unstable_handleError</code>. This method no longer works, and you will need to change it to <code>componentDidCatch</code> in your code starting from the first 16 beta release.</p>

<p>For this change, we’ve provided <a href="https://github.com/reactjs/react-codemod#error-boundaries">a codemod</a> to automatically migrate your code.</p>

</div>



      </div>
    
      <div class="post-list-item">
        

<h1>

  <a href="/react/blog/2017/06/13/react-v15.6.0.html">React v15.6.0</a>

</h1>

<p class="meta">
  June 13, 2017
  by
  
    
      <a href="https://twitter.com/ProbablyFlarnie">Flarnie Marchan</a>
    
    
  
</p>

<hr>

<div class="post">
  <p>Today we are releasing React 15.6.0. As we prepare for React 16.0, we have been fixing and cleaning up many things. This release continues to pave the way.</p>

<h2>Improving Inputs</h2>

<p>In React 15.6.0 the <code>onChange</code> event for inputs is a little bit more reliable and handles more edge cases, including the following:</p>

<ul>
<li>not firing when radio button is clicked but not changed (<a href="https://github.com/facebook/react/issues/1471">issue 1471</a>)</li>
<li>changing an input of type <code>range</code> with the arrow keys (<a href="https://github.com/facebook/react/issues/554">issue 554</a>)</li>
<li>pasting text into a text area in IE11 (<a href="https://github.com/facebook/react/issues/7211">issue 7211</a>)</li>
<li>auto-fill in IE11 (<a href="https://github.com/facebook/react/issues/6614">issue 6614</a>)</li>
<li>clearing input with &#39;x&#39; button or right-click &#39;delete&#39; in IE11 (<a href="https://github.com/facebook/react/issues/6822">issue 6822</a>)</li>
<li>not firing when characters are present in the input on render in IE11 (<a href="https://github.com/facebook/react/issues/2185">issue 2185</a>)</li>
</ul>

<p>Thanks to <a href="https://github.com/jquense">Jason Quense</a> and everyone who helped out on those issues and PRs.</p>

<h2>Less Noisy Deprecation Warnings</h2>

<p>We are also including a couple of new warnings for upcoming deprecations. These should not affect most users, and for more details see the changelog below.</p>

<p>After the last release, we got valuable community feedback that deprecation warnings were causing noise and failing tests. <strong>In React 15.6, we have downgraded deprecation warnings to use <code>console.warn</code> instead of <code>console.error</code>.</strong> Our other warnings will still use <code>console.error</code> because they surface urgent issues which could lead to bugs. Unlike our other warnings, deprecation warnings can be fixed over time and won&#39;t cause problems in your app if shipped. We believe that downgrading the urgency of deprecation warnings will make your next update easier. Thanks to everyone who was involved in the discussion of this change.</p>

<hr>

<h2>Installation</h2>

<p>We recommend using <a href="https://yarnpkg.com/">Yarn</a> or <a href="https://www.npmjs.com/">npm</a> for managing front-end dependencies. If you&#39;re new to package managers, the <a href="https://yarnpkg.com/en/docs/getting-started">Yarn documentation</a> is a good place to get started.</p>

<p>To install React with Yarn, run:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">yarn add react@^15.6.0 react-dom@^15.6.0
</code></pre></div>
<p>To install React with npm, run:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">npm install --save react@^15.6.0 react-dom@^15.6.0
</code></pre></div>
<p>We recommend using a bundler like <a href="https://webpack.js.org/">webpack</a> or <a href="http://browserify.org/">Browserify</a> so you can write modular code and bundle it together into small packages to optimize load time.</p>

<p>Remember that by default, React runs extra checks and provides helpful warnings in development mode. When deploying your app, make sure to <a href="/react/docs/optimizing-performance.html#use-the-production-build">use the production build</a>.</p>

<p>In case you don&#39;t use a bundler, we also provide pre-built bundles in the npm packages which you can <a href="/react/docs/installation.html#using-a-cdn">include as script tags</a> on your page:</p>

<ul>
<li><strong>React</strong><br/>
Dev build with warnings: <a href="https://unpkg.com/react@15.6.0/dist/react.js">react/dist/react.js</a><br/>
Minified build for production: <a href="https://unpkg.com/react@15.6.0/dist/react.min.js">react/dist/react.min.js</a><br/></li>
<li><strong>React with Add-Ons</strong><br/>
Dev build with warnings: <a href="https://unpkg.com/react@15.6.0/dist/react-with-addons.js">react/dist/react-with-addons.js</a><br/>
Minified build for production: <a href="https://unpkg.com/react@15.5.0/dist/react-with-addons.min.js">react/dist/react-with-addons.min.js</a><br/></li>
<li><strong>React DOM</strong> (include React in the page before React DOM)<br/>
Dev build with warnings: <a href="https://unpkg.com/react-dom@15.6.0/dist/react-dom.js">react-dom/dist/react-dom.js</a><br/>
Minified build for production: <a href="https://unpkg.com/react-dom@15.6.0/dist/react-dom.min.js">react-dom/dist/react-dom.min.js</a><br/></li>
<li><strong>React DOM Server</strong> (include React in the page before React DOM Server)<br/>
Dev build with warnings: <a href="https://unpkg.com/react-dom@15.6.0/dist/react-dom-server.js">react-dom/dist/react-dom-server.js</a><br/>
Minified build for production: <a href="https://unpkg.com/react-dom@15.6.0/dist/react-dom-server.min.js">react-dom/dist/react-dom-server.min.js</a><br/></li>
</ul>

<p>We&#39;ve also published version <code>15.6.0</code> of <code>react</code> and <code>react-dom</code> on npm, and the <code>react</code> package on bower.</p>

<hr>

<h2>Changelog</h2>

<h2>15.6.0 (June 13, 2017)</h2>

<h3>React</h3>

<ul>
<li>Downgrade deprecation warnings to use <code>console.warn</code> instead of <code>console.error</code>. (<a href="https://github.com/flarnie">@flarnie</a> in <a href="https://github.com/facebook/react/pull/9753">#9753</a>)</li>
<li>Add a deprecation warning for <code>React.createClass</code>. Points users to <code>create-react-class</code> instead. (<a href="https://github.com/flarnie">@flarnie</a> in <a href="https://github.com/facebook/react/pull/9771">#9771</a>)</li>
<li>Add deprecation warnings and separate module for <code>React.DOM</code> factory helpers. (<a href="https://github.com/nhunzaker">@nhunzaker</a> in <a href="https://github.com/facebook/react/pull/8356">#8356</a>)</li>
<li>Warn for deprecation of <code>React.createMixin</code> helper, which was never used. (<a href="https://github.com/aweary">@aweary</a> in <a href="https://github.com/facebook/react/pull/8853">#8853</a>)</li>
</ul>

<h3>React DOM</h3>

<ul>
<li>Add support for CSS variables in <code>style</code> attribute. (<a href="https://github.com/aweary">@aweary</a> in <a href="https://github.com/facebook/react/pull/9302">#9302</a>)</li>
<li>Add support for CSS Grid style properties. (<a href="https://github.com/ericsakmar">@ericsakmar</a> in <a href="https://github.com/facebook/react/pull/9185">#9185</a>)</li>
<li>Fix bug where inputs mutated value on type conversion. (<a href="https://github.com/mhunzaker">@nhunzaker</a> in <a href="https://github.com/facebook/react/pull/9806">#9806</a>)</li>
<li>Fix issues with <code>onChange</code> not firing properly for some inputs. (<a href="https://github.com/jquense">@jquense</a> in <a href="https://github.com/facebook/react/pull/8575">#8575</a>)</li>
<li>Fix bug where controlled number input mistakenly allowed period. (<a href="https://github.com/nhunzaker">@nhunzaker</a> in <a href="https://github.com/facebook/react/pull/9584">#9584</a>)</li>
<li>Fix bug where performance entries were being cleared. (<a href="https://github.com/chrisui">@chrisui</a> in <a href="https://github.com/facebook/react/pull/9451">#9451</a>)</li>
</ul>

<h3>React Addons</h3>

<ul>
<li>Fix AMD support for addons depending on <code>react</code>. (<a href="https://github.com/flarnie">@flarnie</a> in <a href="https://github.com/facebook/react/issues/9919">#9919</a>)</li>
<li>Fix <code>isMounted()</code> to return <code>true</code> in <code>componentWillUnmount</code>. (<a href="https://github.com/mridgway">@mridgway</a> in <a href="https://github.com/facebook/react/issues/9638">#9638</a>)</li>
<li>Fix <code>react-addons-update</code> to not depend on native <code>Object.assign</code>. (<a href="https://github.com/gaearon">@gaearon</a> in <a href="https://github.com/facebook/react/pull/9937">#9937</a>)</li>
<li>Remove broken Google Closure Compiler annotation from <code>create-react-class</code>. (<a href="https://github.com/gaearon">@gaearon</a> in <a href="https://github.com/facebook/react/pull/9933">#9933</a>)</li>
<li>Remove unnecessary dependency from <code>react-linked-input</code>. (<a href="https://github.com/gaearon">@gaearon</a> in <a href="https://github.com/facebook/react/pull/9766">#9766</a>)</li>
<li>Point <code>react-addons-(css-)transition-group</code> to the new package. (<a href="https://github.com/gaearon">@gaearon</a> in <a href="https://github.com/facebook/react/pull/9937">#9937</a>)</li>
</ul>

</div>



      </div>
    

    <div class="pagination">
      
      
        <a href="/react/blog/page2/" class="next">
          Next Page &raquo;
        </a>
      
    </div>
  </div>
</section>


    <footer class="nav-footer">
  <section class="sitemap">
    <a href="/react/" class="nav-home">
    </a>
    <div>
      <h5><a href="/react/docs/">Docs</a></h5>
      <a href="/react/docs/hello-world.html">Quick Start</a>
      <a href="/react/docs/thinking-in-react.html">Thinking in React</a>
      <a href="/react/tutorial/tutorial.html">Tutorial</a>
      <a href="/react/docs/jsx-in-depth.html">Advanced Guides</a>
    </div>
    <div>
      <h5><a href="/react/community/support.html">Community</a></h5>
      <a href="http://stackoverflow.com/questions/tagged/reactjs" target="_blank">Stack Overflow</a>
      <a href="https://discuss.reactjs.org/" target="_blank">Discussion Forum</a>
      <a href="https://discord.gg/0ZcbPKXt5bZjGY5n" target="_blank">Reactiflux Chat</a>
      <a href="https://www.facebook.com/react" target="_blank">Facebook</a>
      <a href="https://twitter.com/reactjs" target="_blank">Twitter</a>
    </div>
    <div>
      <h5><a href="/react/community/support.html">Resources</a></h5>
      <a href="/react/community/conferences.html">Conferences</a>
      <a href="/react/community/videos.html">Videos</a>
      <a href="https://github.com/facebook/react/wiki/Examples" target="_blank">Examples</a>
      <a href="https://github.com/facebook/react/wiki/Complementary-Tools" target="_blank">Complementary Tools</a>
    </div>
    <div>
      <h5>More</h5>
      <a href="/react/blog/">Blog</a>
      <a href="https://github.com/facebook/react" target="_blank">GitHub</a>
      <a href="http://facebook.github.io/react-native/" target="_blank">React Native</a>
      <a href="/react/acknowledgements.html">Acknowledgements</a>
    </div>
  </section>
  <a href="https://code.facebook.com/projects/" target="_blank" class="fbOpenSource">
    <img src="/react/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/>
  </a>
  <section class="copyright">
    Copyright © 2017 Facebook Inc.
  </section>
</footer>

  </div>

  <div id="fb-root"></div>
  <script src="/react/js/anchor-links.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-41298772-1', 'facebook.github.io');
    ga('send', 'pageview');

    !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");

    (function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.6&appId=623268441017527";
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));

    docsearch({
      apiKey: '36221914cce388c46d0420343e0bb32e',
      indexName: 'react',
      inputSelector: '#algolia-doc-search'
    });
  </script>
</body>
</html>
